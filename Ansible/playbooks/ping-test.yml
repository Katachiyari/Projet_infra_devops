---
- name: Test ping/pong VMs Proxmox
  hosts: all
  gather_facts: false
  tasks:
    - name: Attendre que SSH soit prêt
      ansible.builtin.wait_for_connection:
        timeout: 120

    - name: Ping connectivity
      ansible.builtin.ping:
      register: ping_result

    - name: Afficher résultat
      ansible.builtin.debug:
        msg: "{{ inventory_hostname }}: {{ 'SUCCESS' if ping_result.ping == 'pong' else 'FAILED' }}"
