# Ansible Configuration - Official Best Practices
# Reference: https://docs.ansible.com/ansible/latest/reference_appendices/config.html
# Guide: https://docs.ansible.com/ansible/latest/collections/index.html

[defaults]
# Core settings
inventory = inventory/terraform.generated.yml,inventory/hosts.yml
roles_path = ./roles
collections_paths = ~/.ansible/collections:/usr/share/ansible/collections

# Security and connection
host_key_checking = False
remote_user = ansible
timeout = 30
interpreter_python = auto_silent

# Logging and output configuration
log_path = /tmp/ansible.log

# Output callbacks - use newer display options
force_color = True

# Execution settings - Parallelize connections for faster execution
forks = 5

# Retry settings
retry_files_enabled = True
retry_files_save_path = ./retry_files

# Fact caching for improved performance (optional)
gathering = smart
fact_caching = jsonfile
fact_caching_connection = /tmp/ansible_facts
fact_caching_timeout = 86400

# Module settings
library = ./library

# Error handling - Fail fast on undefined variables or missing includes
undefined_var_behavior = error
error_on_undefined_vars = True
verbosity = 0

[ssh_connection]
# SSH connection options (official best practices for ProxyJump support)
ssh_args = -o StrictHostKeyChecking=no -o ControlMaster=auto -o ControlPersist=60s
pipelining = True
control_path = /tmp/ansible-ssh-%%h-%%p-%%r
