---
# =============================================================================
# Rôle : edgedoc
# Fichier : roles/edgedoc/defaults/main.yml
#
# Objectif :
# - Déployer HedgeDoc (EdgeDoc) + MariaDB via Docker Compose
# - Appliquer une configuration SSOT (Source Unique de Vérité)
# - Éviter les secrets en clair (DevSecOps) : Vault obligatoire
# =============================================================================

# -----------------------------------------------------------------------------
# SSOT (Source Unique de Vérité) : paramètres d'exposition
# -----------------------------------------------------------------------------
edgedoc_install_dir: "/opt/edgedoc"
edgedoc_port: 8080
edgedoc_fqdn: "edgedoc.lab.local"
edgedoc_scheme: "https"

# -----------------------------------------------------------------------------
# Images Docker (reproductibilité) : versions pinées
# NOTE : DHI (Docker Hardened Images) :
# - À ce jour, pas de DHI “officielle” standard pour HedgeDoc/MariaDB dans ce projet.
# - On privilégie donc les images officielles amont + versions pinées.
# -----------------------------------------------------------------------------
edgedoc_image: "quay.io/hedgedoc/hedgedoc:1.9.9"
mariadb_image: "mariadb:10.11"

# -----------------------------------------------------------------------------
# Backend base de données (réseau Docker interne)
# -----------------------------------------------------------------------------
edgedoc_db_host: "edgedoc-db"
edgedoc_db_port: 3306
edgedoc_db_name: "hedgedoc"
edgedoc_db_user: "hedgedoc"

# -----------------------------------------------------------------------------
# Secrets (doivent venir d'Ansible Vault) - OBLIGATOIRE
# -----------------------------------------------------------------------------
edgedoc_db_password: "{{ vault_edgedoc_db_password }}"
edgedoc_db_root_password: "{{ vault_edgedoc_db_root_password }}"
edgedoc_session_secret: "{{ vault_edgedoc_session_secret }}"

# -----------------------------------------------------------------------------
# Paramètres fonctionnels (SSOT) - évite le hardcoding dans le compose
# -----------------------------------------------------------------------------
edgedoc_allow_anonymous: true
edgedoc_allow_anonymous_edits: true
edgedoc_default_permission: "freely"
